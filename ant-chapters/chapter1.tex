\chapter{Rings of integers}\llabel{ring-of-integers}

We begin with a hint of applications of rings of integers for motivation. We then introduce algebraic numbers to define a few key terms illustrating these concepts with concrete examples. Following that, we will generalize our definitions to arbitrary fields.

\section{Motivation}
A natural way to begin a book about Algebraic Number Theory is by introducing number fields. While we will define them much more precisely and generally soon,
we may temporarily think of them as fields of rational numbers extended by ``external" elements. Rings of integers are similar, but are based on $\Z$ instead.

\begin{ex} A typical ring of integers is $\Z[\sqrt{2}] = \left\{m + n \sqrt{2} : m,n \in \Z\right\}$.
\end{ex}

\noindent This construction is very powerful, and can be used to solve many classical problems, such as:
\begin{itemize}
\item \textbf{Diophantine Equations}: For example, solving the Diophantine equation $x^2 - dy^2 = 1$ (Pell's equation) can be understood as a problem in $\Z(\sqrt{d})$. Without going into detail for now, norm of $x + y\sqrt{d}$ in such ring is defined as $x^2 - dy^2$, which corresponds to equation we're interested in.
\item \textbf{Pythagorean Triples}: In the ring of $\Z[i]$ norm of $a + bi$ is defined as $a^2 + b^2$. This can be used to study integral solutions to $a^2 + b^2 = c^2$ (i.e. Pythagorean Triples).
\item \textbf{Special cases of Fermat's Last Theorem}: For instance, proving that there are no integer solutions to $x^3 + y^3 = z^3$ can be stated using the ring of integers $\Z(\omega)$ (where $\omega$ is a cube root of unity).
\end{itemize}

\noindent In the following sections we'll learn about elements of these rings, and their properties.

\section{Algebraic Numbers}
\begin{df}
\textbf{Algebraic numbers} are complex numbers that are roots of a polynomial with coefficients in $\Q$. The set of algebraic numbers is denoted $\overline{\Q}$.
\end{df}

\begin{ex} Examples of algebraic numbers include:
\begin{itemize}
\item $1$ is a root of $1-x$ and $3x-3$.
\item $\frac{1}{2}$ is a root of $2x - 1$ and $x - \frac{1}{2}$.
\item $\sqrt{2}$ is a root of $x^2 - 2$ and $x^5 + 2x^4 - 2x^3 - 4x^2$.
\item $i$ is a root of $x^2 + 1$.
\end{itemize}
\end{ex}

\begin{df}
A number is algebraic if any such polynomial exist. Since we're working in $\Q$ we can scale the polynomial to be monic (i.e. with 1 as a leading coefficient). The monic polynomial with a smallest degree is called a \textbf{minimal polynomial} over $\Q$.
\end{df}

\begin{df}
The \textbf{degree} of algebraic number $\alpha$ is defined as the degree of its minimal polynomial.
\end{df}

\begin{ex} Examples of minimal polynomials:
\begin{itemize}
\item The minimal polynomial of $1$ is $x-1$. So $\deg 1 = 1$.
\item The minimal polynomial of $\frac{1}{2}$ is $x - \frac{1}{2}$. So $\deg \frac{1}{2} = 1$.
\item The minimal polynomial of $\sqrt{2}$ is $x^2 - 2$. So $\deg \sqrt{2} = 2$.
\item The minimal polynomial of $i$ is $x^2 + 1$. So $\deg i = 2$.
\item The minimal polynomial of $\sqrt[3]{2}$ is $x^3 - 2$. So $\deg \sqrt[3]{2} = 3$.
\end{itemize}
\end{ex}

\begin{df}
If the coefficients of the minimal polynomial are all integers, we call the corresponding algebraic number an \textbf{algebraic integer}. Thus $1$, $i$ and $\sqrt{2}$ are algebraic integers, while $\frac{1}{2}$ is not.
The set of algebraic integers is denoted $\overline{\Z}$.
\end{df}

\begin{df}
Given an algebraic number $\alpha$ with minimal polynomial $P$ of degree $n$, the $n$ roots of $P$ are called the \textbf{conjugates} of $\alpha$.
\end{df}

\begin{ex} Examples of algebraic number conjugates:
\begin{itemize}
\item Conjugates of $1$ over $\Q$ are $\left\{1\right\}$
\item Conjugates of $\sqrt{2}$ over $\Q$ are $\left\{\sqrt{2}, -\sqrt{2}\right\}$
\item Conjugates of $\sqrt[3]{2}$ over $\Q$ are $\left\{\sqrt[3]{2}, \omega\sqrt[3]{2}, \omega^2\sqrt[3]{2}\right\}$. Note that these conjugates don't lie in $\Q(\sqrt[3](2))$.
\end{itemize}
\end{ex}

There is one more interesting aspect about minimal polynomials and conjugates: conjugates always come together.

\begin{thm}
Let $\al$ be an algebraic number with a minimal polynomial $A(x)$, and let $B(x)$ be another polynomial such that $B(\al) = 0$. Then $A(x)$ divides $B(x)$.
\end{thm}
\begin{proof}
By the division algorithm for polynomials, we can express $B(x) = A(x)Q(x) + R(x)$, with $\deg R(x) < \deg A(x)$. By substituting $\al$ we get $0 = R(\al)$.

\noindent If $R(x)$ is not a zero polynomial, we get a contradiction - $\al$ is a root of $R(x)$, which has a degree lower than the degree of the minimal polynomial of $\al$.
Hence, $R(x)$ must be a zero polynomial, and thus $B(x) = A(x)Q(x)$ as desired (proving that $A(x)$ divides $B(x)$).
\end{proof}

This has some nice consequences - for example, if we know $a_1, a_2, \ldots a_n$ are conjugates over $\Q$, and that $P(a_1) = 0$, we immediately infer, without further checking, that $P(a_2) = \ldots = P(a_n) = 0$.
To reuse a previous example, since $\sqrt{2}$ and $-\sqrt{2}$ are conjugates, if we know that $\sqrt{2}$ is a root of $P(x) = x^5 + 2x^4 - 2x^3 - 4x^2$, we immediately conclude that $-\sqrt{2}$ is also a root.

\section{Number fields}

Having defined algebraic numbers, we can now introduce the concept of number fields.

\begin{df}
A \textbf{number field} is a field that contains $\Q$ as a subfield, and is generated by adjoining a finite number of algebraic numbers to $\Q$.
\end{df}

\begin{rem}
$\R$ and $\C$ are not number fields, because they can't be generated by adjoining a \textit{finite} number of elements to $\Q$.
\end{rem}

\begin{ex}
For example, $\Q(\sqrt{2}) = \left\{\frac{a + b \sqrt{2}}{c + d \sqrt{2}} : a,b,c,d \in \Q\right\}$ is a number field.
\end{ex}

\noindent Rationalizing the denominator shows that that this is equivalent to $\Q[\sqrt{2}] = \left\{a + b \sqrt{2} : a,b \in \Q\right\}$. In other words, $\Q(\sqrt{2}) \cong \Q[\sqrt{2}]$. This holds for every algebraic number $\alpha$ (as we prove more generally in Proposition~\ref{l-eq-frac-b}). Therefore, we may consider elements of $\Q(\alpha)$ to be of the form $a + b\alpha$ with $a, b \in \Q$.

\begin{df}
The \textbf{degree} of a number field $K$ over $\Q$, denoted $[K:\Q]$ is the dimension of $K$ as a vector space over $\Q$.
\end{df}

\begin{ex} Number fields as vector spaces:
\begin{itemize}
\item The degree of $\Q(\sqrt{2})$ is equal to 2, with basis being $\left\{1, \sqrt{2}\right\}$.
\item The degree of $\Q(\sqrt[3]{2})$ is equal to 3, with basis being $\left\{1, \sqrt[3]{2}, \sqrt[3]{4}\right\}$.
\item For every algebraic number $\alpha$, the degree of $\Q(\alpha)$ is equal to $\deg \alpha$ (as proved in Lemma~\ref{power-basis}).
\end{itemize}
\end{ex}

\begin{exr}
Verify that $\Q(\alpha)$ forms a $\Q$-vector space
\end{exr}

\noindent Algebraic numbers are just one example of a more generic phenomena. To talk about them more generally we need to first define a few terms:

\begin{df}
Let $A$ be a field, and $L$ be an extension field of $A$. An element $x \in L$ is \textbf{algebraic} over $A$ if it is the zero of a polynomial with coefficient in $A$.
\end{df}

\begin{ex}
Algebraic numbers are, by definition, algebraic over $\Q$. Algebraic integers are also algebraic over $\Q$ (they are also roots of polynomials with coefficients in $\Z$, but we don't say they're algebraic over $\Z$, because $\Z$ is not a field).
\end{ex}

\begin{df}
The \textbf{algebraic closure} of $A$ in $L$ is the set of elements of $L$ algebraic over $A$. If every element of $L$ is algebraic over $A$ we say $L$ is an \textbf{algebraic extension} of A.
\end{df}

\noindent The algebraic closure of $A$ is denoted $\overline{A}$. This is why the algebraic closure of $\Q$ - the set of algebraic numbers - is denoted $\overline\Q$.

\begin{rem}
The algebraic closure of $\R$ is $\C$. The algebraic closure of $\C$ is $\C$, which is a very nice property to have. But beware: algebraic closure of $\Z$ is $\overline\Q$ and not $\overline\Z$.
\end{rem}

\noindent One last definition worth knowing, even though we won't use often, is:

\begin{df}
A field $F$ is \textbf{algebraically closed} if every nonconstant polynomial in $F[x]$ has a root in $F$.
\end{df}

\section{Integrality}

In elementary number theory we're more concerned about integers than about rational or real numbers. Similarly, we would like to have
something similar to integers, but in a more general context of number fields. In this chapter we will define such object and explore its properties.
\index{integral}
\begin{df}\llabel{integral}
Let $A$ be an integral domain and $L$ a field containing $A$. An element of $x\in L$ is \textbf{integral} over $A$ if it is the zero of a monic polynomial with coefficients in $A$:
\[
x^n+a_{n-1}x^{n-1}+\cdots +a_1x+a_0=0,\, n\ge 1,\, a_0,\ldots, a_{n-1}\in A.
\]
%(``$P=0$" is called an equation of integral dependence for $\al$.) 
\end{df}
\begin{ex}
In case when $L = \Q$ and $A = \Z$, this is precisely the definition of algebraic integers. Consequently, algebraic integers are integral over $\Z$.
\end{ex}

\noindent We prove a more generic result about integrality related to algebraic extensions in Proposition~\ref{integral-min-poly}. For now let's define closures and extensions similarly to their algebraic counterparts:

\begin{df}
The \textbf{integral closure} of $A$ in $L$ is the set of elements of $L$ that are integral over $A$. If every element of $L$ is integral over $A$ we say $L$ is an \textbf{integral extension} of $A$.
\end{df}

\begin{df}
In particular, the integral closure of $\Z$ in $L$ is called the \textbf{ring of integers} $\cO_L$.
\end{df}

\begin{ex}
The integral closure of $\Z$ in $\Q$ is simply $\Z$ itself (we see this more generally in Proposition~\ref{rational-roots-thm}). However, the integral closure of $\Z$ in $\C$ (or just in $\overline\Q$) is the set of all algebraic integers $\overline\Z$.
\end{ex}

\noindent Thus the integral closure generalizes the notion of what it means to be an ``integer" in other number fields.
As we will see in Example~\ref{quadratic-extensions}, for $d$ squarefree, the integral closure of $\Q(\sqrt{d})$ is $\Z[\sqrt{d}]$ when $d\equiv 3\pmod 4$ and $\Z\ba{\fc{1+\sqrt{d}}2}$ when $d\equiv 1\pmod 4$.
Algebra is much nicer in integral extensions---which is why, for instance, we would study $\Z\ba{\fc{1+\sqrt{-3}}2}$ rather than just $\Z[\sqrt{-3}]$.
%\begin{rem}
%If $A$ is a PID (for example $A=\Z$), 
%then by Gauss's Lemma this is equivalent to saying that the {\it minimal polynomial} of $x$ has coefficients in $A$.
%\end{rem}

\begin{df}\llabel{integrally-closed}
$A$ is \textbf{integrally closed} or \textbf{normal} if its integral closure in $K=\Frac(A)$ is itself.
\end{df}

\begin{ex}
In other words, if $a \in \Frac(A)$ is integral and $A$ is integrally closed then $a \in A$. For example, $\Z$ is integrally closed, because its integral closure in $\Frac(\Z) = \Q$ is just $\Z$.
\end{ex}

\noindent Here is a short table to list definitions in this section so far, along with their algebraic counterparts:

\begin{center}
  \begin{tabular}{ c | c }
    $\overline\Z$ & $\overline\Q$ \\ \hline
    algebraic integers & algebraic numbers \\ \hline
    integral element & algebraic element \\ \hline
    integral extension & algebraic extension \\ \hline
    integral closure & algebraic closure \\ \hline
    integrally closed & algebraically closed
  \end{tabular}
\end{center}

\noindent Note that integrality is a stronger condition. For example, being integral implies being algebraic.

\begin{thm}\llabel{ring-of-integers-theorem}
Let $L$ be a field containing the ring $A$. Then the elements of $L$ integral over $A$ form a ring.
\end{thm}

\noindent In other words, the integral closure of $A$ in $L$ is a ring. In particular, every ring of integers $\cO_L$ forms a ring.
Before we prove Theorem~\ref{ring-of-integers-theorem}, we need two useful lemmas:

\begin{lem}[Power basis]\llabel{power-basis}
If $\al$ is integral over $A$, i.e. satisfies a monic polynomial of degree $n$, then $A[\al]$ is generated by $1,\al,\ldots, \al^{n-1}$ where $n = \deg \al$.
\end{lem}
\begin{proof}
Since $\alpha$ is a root of the monic polynomial of degree $n$, we have $\alpha^n + a_{n-1}\alpha^{n-1} + ... + a_1\alpha + a_0 = 0$. This can be rearranged to $\alpha^n = -a_{n-1}\alpha^{n-1} - ... - a_1\alpha - a_0$.

\noindent Thus, the set 1, $\alpha$, $\alpha^2, ..., \alpha^{n-1}$ generates $A[\alpha]$, since we can replace $\alpha^n$ untill all powers of $\alpha$ are less than $n$.
\end{proof}

\begin{lem}[Criterion for integrality]\llabel{criterion-for-integrality}
An element $\al\in L$ is integral over $A$ if and only if there exists a nonzero finitely generated $A$-submodule of $L$ such that $\al M\subeq M$. If so, then we can take $M=A[\al]$.
\end{lem}
\begin{ex}
For example, $\frac{1}{\sqrt2}$ fails this criterion over $\Z$---multiplying by it has the effect of making $M$ ``finer." $\sqrt{2}$, however, is integral. In the case $A=\Z$ and $B=\Q$, $a\in \Q$ is integral over $\Z$ iff $a\in \Z$. Indeed, $a\in \Z$ satisfies $x-a$, and if $a\nin \Z$, then powers of $a$ contain arbitrarily large denominators so $\Z[\al]$ is not finitely generated.
\end{ex}

\begin{proof} $\Rightarrow$ by Lemma~\ref{power-basis}.

\noindent $\Leftarrow$: Suppose $M$ is generated by $v_1,\ldots, v_n$. Then we can find a matrix $T$ with coefficients in $A$ such that
\[\al \begin{bmatrix}v_1\\ \vdots \\ v_n\end{bmatrix}=
T\begin{bmatrix}v_1\\ \vdots \\ v_n\end{bmatrix}.\]
Since $v_1,\ldots, v_n\neq 0$, $\al I-T$ is singular, and $\det(\al I-T)=0$. This gives a monic polynomial equation satisfied by $\al$.
\end{proof}

\noindent Now we can easily prove Theorem~\ref{ring-of-integers-theorem}:

\begin{proof}
We need to show that if $a,b$ are integral over $A$ then so are $a+b$ and $ab$.
Now for $\al, \be\in L$ and let $M=A[\al]$ and $N=A[\be]$ note:
\begin{enumerate}
\item If $M,N$ are finitely generated by $\{\al_i\}$ and $\{\be_j\}$, then $MN$ is finitely generated by $\{\al_i\be_j\}$.
\item $\al\be MN\subeq MN$ and $(\al+\be)MN\subeq MN$.
\end{enumerate}
Hence $\al\be$ and $\al+\be$ are integral over $A$ by Lemma~\ref{criterion-for-integrality} as needed.
\end{proof}

\noindent We can also prove Theorem~\ref{ring-of-integers-theorem} in an alternative way, using the properties of symmetric polynomials:

\begin{proof}
Let $p,q$ be the minimal polynomials of $a,b$, let $a_1,\ldots, a_k$ be the conjugates of $a$ and $b_1,\ldots, b_l$ be the conjugates of $b$. %For $r\in A$, the t
The coefficients of
\[%\prod_i (x-ra_i),
\prr{1\le i\le m}{1\le j\le n} (x-(a_i+b_j)),\quad \prr{1\le i\le m}{1\le j\le n} (x-(a_ib_j))\]%,\prod_{i} (x-(1/a_i))\]
are symmetric in the $a_i$ and symmetric in the $b_j$ so by the Fundamental Theorem of Symmetric Polynomials can be written in terms of the elementary symmetric polynomials in the $a_i$ and in the $b_j$, with coefficients in $A$. By Vieta's Theorem these are expressible in terms of the coefficients of $p,q$, which are in $A$. Hence these polynomials have coefficients in $A$. They have $a+b,ab$ as roots, as desired.\\
\end{proof}

\noindent For the rest of this chapter, $A$ is an integral domain, $K$ is its field of fractions, $L$ is an extension of $K$, and $B$ is the integral closure of $A$ in $L$. %This is the setup for much of algebraic number theory.
\begin{equation}\llabel{aklb}
\xymatrix{
  L \ar@{-}[r]\ar@{-}[d] & B\ar@{-}[d]\\
  K \ar@{-}[r]           & A
}
\end{equation}

\noindent Sometimes we call this the ``AKLB" setup for short, if we further assume $A$ is integrally closed in $K$. In the usual case, $A$ is the integral closure of $\Z$ in $K$. in this case, we write $A=\cO_K$.\footnote{Later on, when we take $K$ to be an extension of the $p$-adic field $\Q_p$, we will use $\cO_K$ to denote the integral closure of $\Z_p$ in $K$.}

\begin{ex}
Sometimes to build our intuition we may want to work in a less general setting. In this case we may pick a specific field to work with. Number fields are a natural choice, for example:

\begin{equation}\llabel{aklbex}
\xymatrix{
  \Q(\sqrt{2}) \ar@{-}[r]\ar@{-}[d] & \Z[\sqrt{2}] \ar@{-}[d] \\
  \Q           \ar@{-}[r]           & \Z
}
\end{equation}
\end{ex}

\index{normality}
\begin{pr}\llabel{l-eq-frac-b}
If $L$ is algebraic over $K$ then every element of $L$ can be written as $\fc{b}{a}$ where $b\in B$ and $a\in A$. Thus  $L=\Frac(B)$.
In particular, for any extension $L/\Q$, $\Frac(\cO_L)=L$.
\end{pr}
\begin{proof}
Given $\al\in L$, suppose that it satisfies the equation
\[
P(x):=a_nx^n+a_{n-1}x^{n-1}+\cdots +a_0=0
\]
with $a_0,\ldots, a_n\in K$ and $a_n\ne 0$. Since $\Frac(A)=K$, by multiplying by an element of $A$ as necessary we may assume $a_0,\ldots, a_n\in A$. Then
\[
a_n^{n-1}P\pf xd:=x^n+a_{n-1}x^{n-1}+a_na_{n-2}x^{n-2}+\cdots +a_n^{n-1}a_0.
\]
Hence $a_n\al$ is integral over $A$, i.e. $a_n\al \in B$. This shows $\al$ is in the desired form.

For the last part, take $K=\Q$ and $A=\Z$.
\end{proof}

\index{rational roots theorem}
\begin{thm}[Rational Roots Theorem]\llabel{rational-roots-thm}
A UFD is integrally closed.
\end{thm}
\begin{proof}
Suppose $R$ is a UFD with field of fractions $K$. Let $x\in K$ be integral over $R$; suppose $x$ satisfies
\[
x^n+a_{n-1}x^{n-1}+\cdots +a_0=0
\]
where $a_0,\ldots, a_{n-1}\in R$. Write $x=\frac pq$ where $p,q\in R$ are relatively prime. Then multiplying the above by $q^n$ gives
\begin{align*}
p^n+a_{n-1}p^{n-1}q+\cdots +a_1pq^{n-1} +a_0q^n&=0\\
q(a_{n-1}p^{n-1}+\cdots +a_0q^{n-1})&=-p^n
\end{align*}
Thus $q\mid p$, possible only if $q=1$. This shows $x\in R$.
\end{proof}

\noindent In particular, the integral closure of $\Z$ in $\Q$ is $\Z$.

\begin{pr}\llabel{integral-min-poly-weak}
Let $A$ be an integral domain, $K$ its field of fractions, and $L$ an extension of $K$. Then $\al\in L$ is integral over $A$ iff coefficients of its minimal polynomial $f$ over $K$ are integral over $A$.
\end{pr}
\begin{proof}
The reverse direction follows from \hyperref[integral]{the definition}.
For the forward direction, note that all roots of $f$ are integral over $K$ since they satisfy the same polynomial equation that $\al$ satisfies.
The coefficients of $f$ are polynomial expressions in the roots so are integral over $A$.
\end{proof}

\noindent We can make this proposition a bit stronger if we assume A is integrally closed:

\begin{pr}\llabel{integral-min-poly}
Let $L$, $K$ as before and $A$ be integrally closed. Then $\al\in L$ is integral over $A$ iff its minimal polynomial $f$ over $K$ has coefficients in $A$.
\end{pr}
\begin{proof}
As in Proposition~\ref{integral-min-poly-weak}, but this time note that since $A$ is \hyperref[integrally-closed]{integrally closed}, coefficient $c \in K$ being integral over $A$ implies $c \in A$.
\end{proof}

\begin{pr}[Finite generation]\llabel{finite-generation}$\,$
\vspace{0cm}
\begin{enumerate}
\item Let $A\subeq B\subeq C$ be rings. If $B$ is finitely generated as an $A$-module and $C$ is finitely generated as a $B$-module, then $C$ is finitely generated as an $A$-module.
\item If $B$ is integral over $A$ and finitely generated as an $A$-algebra, then it is finitely generated as an $A$-module.\qedhere
\end{enumerate}
\end{pr}
\begin{proof}$\,$
\vspace{0cm}
\begin{enumerate}
\item Take products of generators.
\item 
Let algebra generators be $\be_1,\ldots, \be_m$. Then
\[A\subeq A[\be_1]\subeq \cdots \subeq A[\be_1,\ldots, \be_m]\]
is a chain of integral extensions, so item 2 follows from 1.\qedhere
\end{enumerate}
\end{proof}
Combining this proposition with Lemma~\ref{criterion-for-integrality} we get the following:
\begin{pr}[Transitivity of integrality]\llabel{integrality}
Let $A\subeq B\subeq C$ be integral domains. If $B$ is integral over $A$ and $C$ is integral over $B$, then $C$ is integral over $A$.
\end{pr}
\begin{proof}
For $\ga\in C$, let $b_i$ be the coefficients of the minimal polynomial of $C$ over $B$. Then $\ga$ is integral over $A[b_0,\ldots, b_m]$, so by Proposition~\ref{finite-generation}, item 2, $A[b_0,\ldots, b_m,\ga]$ is finitely generated over $A$. Since $\ga A[b_0,\ldots, b_m,\ga]\subeq A[b_1,\ldots, b_m,\ga]$, by Lemma~\ref{criterion-for-integrality}, $\ga$ is integral over $A$.
\end{proof}

\begin{lem}\llabel{iterated-closures}
Let $A\subeq B\subeq C$ be integral domains. Let $A'$ be the integral closure of $A$ over $B$ and $A''$ be the integral closure of $A'$ over $C$. Let $A'''$ be the integral closure of $A$ in $C$. %Then $A''=A'''$ and $A'=A''\cap L$.
Then $A''=A'''$.
\end{lem}
\begin{proof}
By Proposition~\ref{integrality} applied to $A\subeq A'\subeq A''$, $A''$ is integral over $A$ so $A''\subeq A'''$. Conversely, any element $a\in A'''$ is integral over $A$ so {\it a fortiori} integral over $A''$; thus $A'''\subeq A''$.
\end{proof}

\begin{pr}
The integral closure of $A$ is integrally closed.
\end{pr}
\begin{proof}
Follows from Lemma~\ref{iterated-closures} applied to $A=B=C$.\qedhere
\end{proof}

\section{Norms and Traces}
Let $B$ be a free $A$-module of rank $n$. Then any element $\be\in B$ defines an $A$-linear map $m_{\be}$ (or $[\be]$), multiplication by $\be$. It is helpful to think of $\be$ as a linear map because then we can apply results from linear algebra.
\begin{df}\llabel{trace-det-char}
The trace, determinant, and characteristic polynomial of $m_{\be}$ are called the {\textbf{trace}}, {\textbf{norm}}, and {\textbf{characteristic polynomial}} of $\be$.
\end{df}
These are computed by choosing any basis of $e_1,\ldots, e_n$ for $B$ over $A$, and then computing the action of $\be$ on this basis.
\begin{pr}[Elementary properties]\llabel{nm-elem-pr}
The following hold ($a\in A; \be,\be'\in B$):
\begin{enumerate}
\item $\tr(\be+\be')=\tr(\be)+\tr(\be')$
\item $\tr(a\be)=a\tr(\be)$
\item $\tr(a)=na$
\item $\nm(\be\be')=\nm(\be)\cdot \nm (\be')$
\item $\nm(a)=a^n$
\end{enumerate}
\end{pr}
\begin{pr}[Behavior with respect to field extensions]\llabel{ntr-fext}
Suppose $L/K$ is a degree $n$ field extension, $M$ is a finite extension of $L$, and $\be\in L$.
\begin{enumerate}
\item (Relationship with roots of minimal polynomial) If $f(X)$ is the minimal polynomial of $\be$ over $K$ and $\be_1,\ldots, \be_m$ are the roots of $f(X)=0$ in a Galois closure of $K$, then letting $r=[L:K(\be)]=\frac nm$, 
\begin{enumerate}
\item
$\chr_{L/K}(\be)=f(X)^r$
\item
$\tr_{L/K}(\be)=r(\be_1+\cdots +\be_m)$
\item
$\nm_{L/K}(\be)=(\be_1\cdots \be_m)^r$
\end{enumerate}
\item (Relationship with embeddings) Suppose $L$ is separable over $K$, $M$ is a Galois extension of $K$, and $\sigma_1,\ldots, \sigma_n$ are the set of distinct embeddings $L\to M$ fixing $K$. 
%(which can be considered as elements of $G(M/K)/G(M/L)$).
Then
\begin{enumerate}
\item
$\tr_{L/K}(\be)=\sigma_1(\be)+\cdots +\sigma_n(\be)$
\item
$\nm_{L/K}(\be)=\sigma_1(\be)\cdots \sigma_n(\be)$
\end{enumerate}
In particular, this is true when $L=M$ is a Galois extension of $K$, and we can think of the $\si_k$ as simply the elements of $G(L/K)$.
\item (Transitivity of trace and norm) Suppose $\be\in M$ and $M/K$ is separable.\footnote{The last condition is not necessary. TODO: Find a proof of the general case.} Then
\begin{enumerate}
\item
$\tr_{M/K}(\be)=\tr_{L/K}(\tr_{M/L}(\be))$
\item
$\nm_{M/K}(\be)=\nm_{L/K}(\nm_{M/L}(\be))$
\end{enumerate}
\item (Integrality) %Let $A$ be an integral domain with fraction field $K$, let $L$ be a finite %separable (not nec.)
%extension of $K$, and $B$ the integral closure of $A$ in $L$.
Assume AKLB. If $\be\in B$, then the coefficients of $\chr_{L/K}(\be)$, and hence $\tr_{L/K}(\be)$ and $\nm_{L/K}(\be)$, are integral over $A$. In particular, if $A$ is integrally closed in $L$ then they are in $A$.
\end{enumerate}
\end{pr}
\begin{proof}$\,$
\begin{enumerate}
\item If $r=1$, i.e. $K[\be]=L$, then by the Cayley-Hamilton Theorem, $f(m_{\be})=0$. Since $f(X)$ is irreducible, $f(X)\mid \chr_{L/K}(\be)$. However, these are monic polynomials of the same degree so they are equal. 

In the general case, take a basis $x_i$ of $K[\be]$ over $K$ and a basis $y_j$ of $L$ over $K[\be]$. Then $x_iy_j$ form a basis of $L$ over $K$, and the matrix of $m_{\be}$ with respect to this basis is $n$ copies of $A$. This proves (a), which implies the rest of the statements.
%
%Alternatively, consider the action of $\be$ on its conjugates.
\item
%All embeddings of $L$ reside in the Galois closure of $L$ so we may assume $M=L^{\text{gal}}$.
%Note the $\si_k$ are restrictions of the automorphisms of $M$ fixing $K$, so we may consider them as automorphisms of $M$ fixing $K$, modded out by those fixing $L$. Then $\{\si_1,\ldots, \si_n\}=G(M/K)/G(M/L)$. Now $G(M/K)$ acts transitively on the conjugates of $\be$, say $\be=\be_1,\ldots, \be_m$, and the stabilizer of any $\be_k$ has order $\frac nm$. Thus the result follows from item 1.
%Let $\be_1,\ldots, \be_m$ be the conjugates of $\be$. Since automorphisms of $M$ fixing $K$ operate transitively on the $\be_k$, we have $\{\si_1(\be),\ldots,\si_n(\be)\}=\{ \be_1,\ldots, \be_m\}$. Each value $\be_k$ must be attained the same number of times, i.e. $r:=\frac nm$ times (since if $\si_j$ takes $\be$ to $\be_k$, it can be written as $\si_{j'}\si_{i}$ for some fixed $j'$ and $\si_i$ taking $\be$ to itself). The result follows from item 1.
Let $\be_1,\ldots, \be_m$ be the conjugates of $\be$. There are $m$ distinct imbeddings $K(\be)\to M$; they each take $\be$ to a different $\be_k$. Each of these imbeddings extend to $r:=[L:K(\be)]=\frac{n}{m}$ imbeddings $L\to M$. %\footnote{If $K\subeq K'\subeq L\subeq M$ and $M$ is Galois over $K$, then each imbedding $K'\to M$ fixing $K$ extends to $[L:K']$ imbeddings $L\to M$ fixing $K$. Proof: Let $\pi$ be the quotient map $G(M/K)/G(M/L)\to G(M/K)/G(M/K')$. Then $\ker \pi=[L:K']$.}
Now use item 1.
\item Note that for any finite extensions $K\subeq L\subeq N$ with $N$ Galois, an imbedding $L\hookrightarrow N$ fixing $K$ can be extended to a $K$-automorphism on $N$, and so be considered an element of the set $G(N/K)/G(N/L)$.\footnote{Using the primitive element theorem, write $L=K(\be)$. The imbeddings $L\to N$ are those taking $\be$ to a conjugate; there are $[L:K]$ imbeddings. But we know $G(N/K)/G(N/L)=[L:K]$, so all of the imbeddings must be extendable. We also use this fact (in addition to a counting argument) in the proof of 2.}

Let $N$ be a Galois extension containing $M$. 
By item 2,
\begin{align*}
\tr_{M/K}(\be)&=\sum_{\si\in G(N/K)/G(N/M)}\si(\be)\\
\tr_{L/K}(\tr_{M/L}(\be))&=\tr_{L/K}\pa{
\sum_{\si\in G(N/L)/G(N/M)}\si(\be)
}\\
&=\sum_{\tau\in G(N/K)/G(N/L)}\sum_{\si\in G(N/L)/G(N/M)}\tau(\si(\be))
\end{align*}
where in the second sum we take arbitrary representatives $\tau\in G(N/K)$ and $\si\in G(N/L)$.
These are equal because for any choice of these representatives, 
\[\{\si\in G(N/K)/G(N/M)\}=\{\tau\si\mid \tau\in G(N/K)/G(N/L),\si\in G(N/L)/G(N/M)\}\]
when considered in $G(N/K)/G(N/M)$ (i.e. as imbeddings $M\hookrightarrow N$ fixing $K$). 
The same is true of the norm.
\item 
The minimal polynomial of $\al$ has coefficients in $A$, by Proposition~\ref{integral-min-poly}. Hence the result follows from item 1.
%Suppose $P(\be)=0$ where $P$ is monic with coefficients in $A$. 
%The conjugates of $\be$ with respect to $K$ are all integral over $A$ since they are also zeros of $P$.
%
%Let $f(X)$ be the minimal polynomial. (Warning: $f(X)$ may be different from $P(X)$.) The coefficients of $f(X)$ are symmetric polynomials of the conjugates, so are integral over $A$. The conclusion follows from item 1. For the second part, note that the coefficients of $f(X)$ are (by definition) in $K$.\qedhere
\end{enumerate}
\end{proof}
\section{Discriminant}
\begin{df}\llabel{disc-df}
%For $L$ a finite extension of $K$, $B(\al,\be):=\tr_{L/K}(\al \be)$ is a symmetric bilinear form on $L$ as a vector space over $K$. The \textbf{discriminant} of $\be$ is the discriminant of the bilinear form,
%\[D(
%
If $B$ is a ring and free $A$-module of rank $m$, and $\be_1,\ldots, \be_m\in B$, then their \textbf{discriminant} is
\[D(\be_1,\ldots, \be_m)=\det[\tr_{B/A}(\be_i\be_j)]_{1\leq i,j\leq m}.\]

\begin{pr}\llabel{disc-basis}
If the change of basis matrix from $\ga_i$ to $\be_i$ is $T$, then 
\[D(\ga_1,\ldots, \ga_m)=\det(T)^2\cdot D(\be_1,\ldots, \be_m).\] 
\end{pr}
\begin{proof}
Let $M_1$ and $M_2$ be the matrices of the bilinear form
\[
(\al,\al')=\tr_{B/A}(\al\al')
\]
with respect to the bases $(\be_1,\ldots, \be_m)$ and $(\ga_1,\ldots, \ga_m)$, respectively.
Then, using the change of basis formula for bilinear forms,
\begin{align*}
D(\be_1,\ldots, \be_m) &= \det(M_1)\\
D(\ga_1,\ldots, \ga_m) &=\det(M_2)\\
M_2&=T^tM_1T\\
\det(M_2)&=\det(T)^2\cdot \det(M_1)
\end{align*}
from which the result follows.
\end{proof}

Consider the discriminant of an arbitrary basis of $B$ over $A$. 
By the above fact, this is well-defined up to multiplication by the square of a unit. The residue in $A/(A^{\times})^2$ is called the discriminant $\disc(B/A)$. The discriminant also refers to the ideal of $A$ this element generates.

Note $\disc(B/A)$ can be thought of as the determinant of the matrix of the bilinear form $(\be,\be')=\tr_{B/A}(\be\be')$.
\end{df}
\begin{pr}[Criterion for integral basis]\llabel{crit-int-basis}
Let $A\subeq B$ be integral domains and $B$ be a free $A$-module of rank $m$ with $\disc(B/A)\neq 0$. Then $\ga_1,\ldots, \ga_m\in B$ form a basis for $B$ as an $A$-module iff
\[(D(\ga_1,\ldots, \ga_m))=(\disc(B/A))\]
as ideals.
\end{pr}
\begin{proof}
Let $\be_i$ be a basis. 
If the change of basis matrix from $\ga_i$ to $\be_i$ is $T$, then by Proposition~\ref{disc-basis},
\[
D(\ga_1,\ldots, \ga_m)=\det(T)^2\cdot D(\be_1,\ldots, \be_m)
=\det(T)^2\disc(B/A)
\]
%In the remark above,
Now $\ga_i$ is basis iff $T$ is invertible, iff $\det(T)$ is a unit, iff $(D(\ga_1,\ldots, \ga_m))=(\disc(B/A))$.
\end{proof}
\begin{pr}[Discriminants and Field Extensions]\llabel{disc-and-fe}$\,$
\begin{enumerate}
\item (Relationship with embeddings)
Let $L$ be separable finite over $K$ of degree $m$, and $\sigma_1,\ldots,\sigma_m$ be the embeddings of $L$ into a Galois extension $M$ fixing $K$. Then for any basis $\be_1,\ldots, \be_m$ of $L$ over $K$,
\[
D(\be_1,\ldots, \be_m)=\det(\sigma_i\be_j)^2\neq 0.
\]
%\item (from LF, Serre p.51; add proof) If $M/L$ is separable of degree $n$, $L/K$ is separable, and $B,C,A$ are the ring of integers, then
%\[
%\disc(C/A)=\disc(B/A)^n\nm(\disc(C/B)).
%\]
\item (Nondegeneracy of trace pairing) If $B$ is free of rank $m$ over $A$ (with fraction fields $K,L$ as above), then the pairing \[(\be,\be')\mapsto \tr(\be\be')\] is a perfect $K$-bilinear pairing, and $\disc(B/A)=\disc(K/L)\neq 0$.
\end{enumerate}
Here {\it perfect} means that the map $a\mapsto (b\mapsto (a,b))$ is an isomorphism $L\to L^*$, and similarly for $b\mapsto (a\mapsto(a,b))$. This is equivalent to saying that the bilinear form is nondegenerate. %compare to nondegenerate 
\end{pr}
\begin{proof} (Unfinished) 
Use Proposition~\ref{ntr-fext}(1b), and that $\si_k,\det$ are both multiplicative. Inequality follows from independence of characters:

Let $G$ be a group, $F$ a field. Then the homomorphisms $G\to F^{\times}$ are linearly independent. 
%(In fact, the same is true if $F^{\times}$ is replaced by $\End(V)$ where $V$ is a finite-dimensional vector space over $F$.)?
\end{proof}
Thus for $K$ of degree $m$ over $\Q$, we can talk of $\disc(\cO_K/\Z)$.

A closely related quantity to the discriminant is the {\it different}.
\begin{df}
Assume AKLB, and suppose $L/K$ is a finite separable extension. The \textbf{codifferent} of $B$ with respect to $A$ is
\[
B^*=\{y\in L\mid \tr(xy)\in A \text{ for all }x\in B\}.
\]
The \textbf{different} of $B$ with respect to $A$ is
\[
\mathfrak D_{B/A}=(B^*)^{-1}.
\]
In other words, it is the largest $B$-submodule satisfying $\tr(E)\subeq A$.
\end{df}
Note that $\mD_{B/A}=(B^*)^{-1}$.
\begin{rem}\llabel{two-def-disc}
We will define the discriminant in general, when $B$ is not necessarily a free $A$-module, in Chapter~\ref{ramification}.
The relationship between the two definitions is the following: Let $\mfp$ be an ideal in $A$. Then $A_{\mfp}$ is a principal ideal domain (in fact, a DVR). Let $S=A-\mfp$; then $S^{-1}B$ is free over $S^{-1}A$ by the structure theorem for modules. We have $(\disc(S^{-1}B/S^{-1}A))=(\mfp A_{\mfp})^{m(\mfp)}$ for some $m(\mfp)$. Then
\[
\disc(B/A)=\prod_{\mfp}\mfp^{m(\mfp)}.
\]
\end{rem}
%(TODO: Add Serre's alternative description of the discriminant (def'd in terms of $\chi$).)

%Note that $\mathfrak D_{B/A}\subeq B\subeq B^*$.
%\begin{pr}(Behavior with respect to field extensions)
%Suppose
%\[
%\xymatrix{
%M\ar@{-}^n[r]\ar@{-}[d]&C\ar@{-}[d]\\
%L\ar@{-}[r]\ar@{-}[d]&B\ar@{-}[d]\\
%K\ar@{-}[r]&A
%}.
%\]
%\begin{enumerate}
%\item (Transitivity) 
%$\mathfrak D_{C/A}=\mathfrak D_{C/B}\mathfrak D_{B/A}$.
%\item Blah.
%\end{enumerate}
%[TODO: Add differential characterization of different.]
%\end{pr}
\section{Integral bases}
\begin{pr}[Finite generation of integral extensions]\llabel{fgoie}
Let $A$ be integrally closed and $L$ separable of degree $m$ over $K$. There are free finite $A$-submodules $M$ and $M'$ of $L$ such that $M\subeq B\subeq M'$.
$B$ is a finitely generated $A$-module if $A$ is Noetherian, and free of rank $m$ if $A$ is a PID.\footnote{Alternative proof: proceed as in 5.8.}
\end{pr}
\begin{proof}
Let $\{\be_1,\ldots, \be_m\}\subeq B$ be a basis for $L$ over $K$. Take a basis $\be_i'$ so that $\tr(\be_i\be_j')=\delta_{ij}$. Then
\[A\be_1+\cdots +A\be_m\subeq B\subeq A\be_1'+\cdots +A\be_m'.\]
The second inclusion follows because if $\be\in B$, then writing $\be=\sum_j b_j\be_j'$, we have that $b_i=\tr(\be\be_i)\in A$. (In other words, the $\be_i'$ form a basis for the codifferent $B^*$, which contains $B$.)\fixme{Move some of the stuff on codiff?}

If $A$ is Noetherian, then $M'$ is finitely generated, so its submodule $B$ is finitely generated over $A$. If $A$ is a PID, then by the Structure Theorem for Modules (over PIDs), $M$ is a direct sum of cyclic modules and a free module. Since it is contained in a free module of rank $m$ and contains a free module of rank $m$, it must be free of rank $m$.
\end{proof}
The following is immediate:
\begin{thm}
If $K$ is finite over $\Q$ (i.e. a number field), then $\cO_K$ is a finitely generated $\Z$-module. It is the largest subring that is finitely generated over $\Z$.
\end{thm}
\begin{df}
A basis for $\cO_K$ as a $\Z$-module is called an \textbf{integral basis}.
\end{df}
\begin{pr}\llabel{disc-calc}
Suppose $K$ has characteristic 0 (so $L$ separable over $K$), $L=K[\be]$, and $f$ is the minimal polynomial of $\be$ over $K$. Let $f(X)=\prod (X-\be_i)$ in the Galois closure of $L$. Then 
\[D(1,\be,\ldots, \be^{m-1})=\prod_{1\leq i<j\leq m}(\be_i-\be_j)^2=(-1)^{m(m-1)/2}\cdot \nm_{L/K}(f'(\be)).\]
This is called the discriminant of $f$.\footnote{This gives an alternative proof of the perfect pairing. }
\end{pr}
\begin{proof}
Note the $\be_i$ are conjugates of $\be$; assume $\be=\be_1$.

By Proposition~\ref{disc-and-fe}, we have
\[
D(1,\be,\ldots, \be^{m-1})=
\left|\begin{array}{cccc}
1 & \be_{1} & \cdots & \be_1^{m-1}\\
1 & \be_{2} & \cdots & \be_{2}^{m-1}\\
\vdots & \vdots & \ddots & \vdots\\
1 & \be_{m} & \cdots & \be_{m}^{m-1}\end{array}\right|^{2}
=
\prod_{1\leq i<j\leq m}(\be_i-\be_j)^2,
\]
where the last statement follows by evaluating the Vandermonde determinant.

For the second equality, note by Proposition~\ref{ntr-fext}(1c) that
\begin{align*}
\nm_{L/K}(f'(\be))=\nm_{L/K}((\be_1-\be_2)\cdots (\be_1-\be_m))&=\prod_{1\le i\le m}\prod_{1\le j\le m,\,j\ne i}
(\be_i-\be_j)\\
&=(-1)^{\frac{m(m-1)}2}
\prod_{1\leq i<j\leq m}(\be_i-\be_j)^2.
\end{align*}
\end{proof}
\begin{pr}%\llabel{crit-int-basis}
If $K=\Q[\al]$, $\al\in \cO_K$, and $D(1,\al,\ldots, \al^{m-1})=\disc(\cO/\Z)$ then $\{1,\al,\ldots, \al^{m-1}\}$ is an integral basis.
\end{pr}
\begin{proof}
Using change-of-basis and the correspondence between index and determinant,
\[
D(1,\al,\ldots, \al^{m-1})=\disc(\cO_K/\Z)\cdot [\cO_K:\Z[\al]]^2.
\]
Now $\disc(\cO_K/\Z)\in \Z$ so $[\cO_K:\Z[\al]]=1$.
\end{proof}
\begin{thm}[Stickelberger's Theorem]\llabel{stickelberger}$\,$
\begin{enumerate}
\item Let $s$ is the number of %of injections $K\to \C$ whose image is not contained in $\R$. 
complex (nonreal) embeddings $K\to \C$. 
Then
\[\sign[\disc(K/\Q)]=(-1)^{s/2}.\] 
\item $\disc(\cO_K/\Z)\equiv 0\ore 1\pmod 4$.
\end{enumerate}
\end{thm}
\begin{proof}
\begin{enumerate}
\item
%
%Let $\al_1,\ldots, \al_m$ be an integral basis. Let 
%
%Then
%\begin{align*}
%\disc(\cO_K/\Z)&=\det(\si_i\al_j)^2\\
%&=(P-N)^2\\
%&=(P+N)^2-4PN.
%\end{align*}
%Take $\si\in G(K^{\text{gal}}/\Q)$. Note composition by $\si$ permutes the $\si_i$, say by $\nu$. Then 
%\begin{align*}
%P&=\sum_{\text{even }\pi\in S_m}\prod_{i=1}^m\si_i\al_{\nu^{-1}\pi(i)}\\
%N&=\sum_{\text{odd }\pi\in S_m}\prod_{i=1}^m\si_i\al_{\nu^{-1}\pi(i)}\\
%\end{align*}
%and hence $\si$ permutes $\{P,N\}$. We conclude $\si$ fixes $P+N,PN$ and these are rational. Since they are integral over $\Z$ they are integers. Thus $\disc(\cO_K/\Z)\equiv (P+N)^2\equiv 0 \text{ or } 1\pmod4$.
%
Write $K=\Q[\al]$ by the Primitive Element Theorem and $\al_1,\ldots, \al_r$ be the real conjugates and $\be_1,\ol{\be_1},\ldots, \be_s,\ol{\be_s}$ be the complex conjugates. By Proposition~\ref{disc-calc},
\[\sign(D(1,\al,\ldots, \al^{m-1}))=\sign\pa{\prod_{1\le j\le s} (\be_j-\ol{\be_j})^2}=\prod_{1\le j\le s}i^2=(-1)^{s/2}.\]
\item Let $\al_1,\ldots, \al_m$ be an integral basis. Let $P$ and $-N$ be the sum of the terms in the expansion of $\det(\si_i\al_j)$ corresponding to even and odd permutations, respectively:
\begin{align*}
P&=\sum_{\text{even }\pi\in S_m}\prod_{i=1}^m\si_i\al_{\pi(i)}\\
N&=\sum_{\text{odd }\pi\in S_m}\prod_{i=1}^m\si_i\al_{\pi(i)}.
\end{align*}
Then
\begin{align*}
\disc(\cO_K/\Z)&=\det(\si_i\al_j)^2\\
&=(P-N)^2\\
&=(P+N)^2-4PN.
\end{align*}
Take $\si\in G(K^{\text{gal}}/\Q)$. Note composition by $\si$ permutes the $\si_i$, say by $\nu$. Then 
\begin{align*}
P&=\sum_{\text{even }\pi\in S_m}\prod_{i=1}^m\si_i\al_{\nu^{-1}\pi(i)}\\
N&=\sum_{\text{odd }\pi\in S_m}\prod_{i=1}^m\si_i\al_{\nu^{-1}\pi(i)}\\
\end{align*}
and hence $\si$ permutes $\{P,N\}$.
%Note any $\si\in G(K^{\text{gal}}/\Q)$ permutes $\{P,N\}$, so 
Hence $\si$ fixes $P+N,PN$ and they are rational. Since they are integral over $\Z$ they are integers. Thus the above is congruent to 0 or 1 modulo 4.
\end{enumerate}
\end{proof}

\begin{ex}[Quadratic extensions]\llabel{quadratic-extensions}
Any quadratic extension of $\Q$ is in the form $\Q(\sqrt{m})$ for some squarefree integer $m$. We find the ring of integers of $\Q(\sqrt{m})$. Consider two cases.
\begin{enumerate}
\item $m\equiv 2,3\pmod 4$: The minimal polynomial of $\sqrt m$ is $X^2-m$, so
\[
\disc(1,\sqrt m)=(\sqrt m-(-\sqrt m))^2=4m.
\]
Note $\frac{\disc (1,\sqrt m)}{\disc(\Q(\sqrt m)/\Q)}$ must be a square by Proposition~\ref{disc-basis} so $\disc(\Q(\sqrt m)/\Q)$ equals $m$ or $4m$. 
However, by Stickelberger's Theorem, $\disc(\Q(\sqrt m)/\Q)\equiv 0,1\pmod 4$. Hence $\disc(\Q(\sqrt m)/\Q)\ne m$ and $\disc(\Q(\sqrt m)/\Q)=4m$. By Proposition~\ref{crit-int-basis}, $1,\sqrt m$ is an integral basis.
\item $m\equiv 1\pmod 4$: Note $\frac{1+\sqrt m}2$ is integral with minimal polynomial $X^2-X-\frac{m-1}{4}$, so
\[
\disc\pa{1,\frac{1+\sqrt m}2}=\pa{\frac{1+\sqrt m}2-\frac{1-\sqrt m}2}^2=m.
\]
Since $m$ is squarefree, $\disc(\Q(\sqrt m)/\Q)=m$ and Proposition~\ref{crit-int-basis} says $1,\frac{1+\sqrt m}2$ is an integral basis. 
\end{enumerate}
\end{ex}

The following tells us about integral bases for products of fields. \fixme{Can we generalize from $\Q$ to extensions of $\Q$?}
\begin{pr}\llabel{disc-compositum}
Suppose that $K,L$ are field extensions of $\Q$ such that
\[
[KL:\Q]=[K:\Q][L:\Q].
\]
Let $d=\gcd(\disc(K/\Q),\disc(L/\Q))$. 
Then 
\begin{enumerate}
\item $\cO_K\subeq d^{-1}\cO_K\cO_L$.
\item If $\cO_{KL}=\cO_K\cO_L$, then $\disc(KL/\Q)=\disc(K/\Q)^{[L:\Q]}\disc(L/\Q)^{[K:\Q]}$.
\end{enumerate}
\end{pr}
\fixme{In particular, COROLLARY.}
\begin{proof}
Let $\{\al_1,\ldots, \al_m\}$ be an integral basis for $K$ and $\{\be_1,\ldots, \be_n\}$ be an integral basis for $L$. By the degree assumption, we know that $\{\al_i\be_j\}$ is a basis for $KL$ over $\Q$. Any element of $KL$ integral over $\Q$ can be written as
\begin{equation}\llabel{ga-integral}
\ga=\sumr{1\le i\le m}{1\le j\le m}{} \frac{a_{ij}}{r}\al_i\be_j
\end{equation}
where $\gcd(r,\gcd(a_{ij}))=1$. 

We need to show that $r\mid d$. Let $x_i=\sum_{j=1}^n \frac{a_{ij}}{r}\be_j$. We will turn~(\ref{ga-integral}) into a system of equations by considering all embeddings $K\hra \C$, solve for the $x_i$ using Cramer's rule, and in this way show that each $x_i$ is an algebraic integer in $L$ divided by a bounded denominator.

Note given embeddings $\si_K:K\hra \C$ and $\si_L:L\hra \C$, there is exactly one embedding $\si_{KL}:KL\hra \C$ such that restricts to $\si_K$ and $\si_L$. It is clearly unique if it exists. To show existence, write $K=\Q(\al)\cong\Q(x)/(f(x))$ by PET, and note that the characteristic polynomial of $f$ does not change upon passing to $L$ because of the degree assumption. Hence $KL=L(\al)=L(x)/(f(x))$, and in extending $\si_L$ to $\si_{KL}$, we are allowed to send $\al=x$ to $\si_L(\al)$.

Fix an embedding $\si:L\hra \C$, and let $\si_1,\ldots, \si_m$ be all embeddings $K\hra \C$. Then applying $\si_k$ to~\ref{ga-integral} we obtain the system of equations
\[
\sum_{i=1}^m \si_k(\al_i) x_i =\si_k(\ga),\quad 1\le k\le m.
\]
By Cramer's rule, letting $D=\det[(\si_k(\al_i))_{k,i}]$ we get $Dx_i=D_i$ where $D_i$ has the $i$th column of $D$ replaced by $(\si_k(\al_i))_{k=1}^m$. Note that $D$ and $D_i$ are both algebraic integers.
Using $\disc(\cO_K/\Z)=D^2$ (Proposition~\ref{disc-and-fe}), we get
\[
\disc(\cO_K/\Z)x_i=DD_i.
\]
Hence $\disc(\cO_K/\Z)x_i$ is an algebraic integer (in $\cO_L$). Since the $\be_j$ are an integral basis for $\cO_L$, this forces $r\mid \disc(\cO_K/\Z)$. Similarly, $r\mid \disc(\cO_L/\Z)$, as needed.

Now we prove the second part. Choose $(\al_1,\ldots, \al_m)$ a basis for $K/\Q$ and $(\be_1,\ldots, \be_n)$ a basis for $L/\Q$. Then $(\al_j\be_k)_{1\le j\le m,1\le k\le n}$ is a basis for $KL/\Q$. For $\ga\in KL$, let $(\ga)_{j,k}$ denote the coordinate of $\al_j\be_k$ in $\ga$. Then the $mn\times mn$ matrix
\begin{align*}
[\tr(\al_{i_1}\be_{i_2}\al_{i_1'}\be_{i_2'})]
&=\ba{\sum_{1\le j\le m,1\le k\le n} (\al_{i_1}\be_{i_2}\al_{i_1'}\be_{i_2'}\al_j\be_k)_{j,k}}\\
&=\ba{\sum_{1\le j\le m,1\le k\le n} (\al_{i_1}\al_{i_1'}\al_j)_j(\be_{i_2}\be_{i_2'}\be_k)_{k}}\\
&=\ba{\sum_{1\le j\le m} \sum_{1\le k\le n} (\al_{i_1}\al_{i_1'}\al_j)_j(\be_{i_2}\be_{i_2'}\be_k)_{k}}\\
&=
[\tr(\al_{i_1}\al_{i_1'})]\otimes[\tr(\be_{i_2}\be_{i_2'})].
\end{align*}
Taking determinants and using 
\[
\det(A\otimes B)=\det(A)^n\det(B)^m,\quad A\in M_{m\times m},B\in M_{n\times n}
\]
we get
\[
\disc(KL/\Q)=\disc(K/\Q)^{[L:\Q]}\disc(L/\Q)^{[M:\Q]}.
\]
\end{proof}
\fixme{[ADD an algorithm for computing integral bases]}

\section{Problems}
\begin{enumerate}
\item Suppose that $f\in\mathbb{Z}[x]$ is irreducible and has a root of absolute value at least $\frac 32$. Prove that if $\alpha$ is a root of $f$ then $f(\alpha^3+1)\neq 0$.

\item Let $a_1,\ldots, a_n$ be algebraic integers with degrees $d_1,\ldots, d_n$. Let $a_1',\ldots, a_n'$ be the conjugates of $a_1,\ldots, a_n$ with greatest absolute value. Let $c_1,\ldots, c_n$ be integers. Prove that if the LHS of the following expression is not zero, then
\[|c_1a_1+\ldots+c_na_n|\geq\left(\frac{1}{|c_1a_1'|+\cdots+|c_na_n'|}\right)^{d_1d_2\cdots d_n-1}.\]
For example, 
\[|c_1+c_2\sqrt{2}+c_3\sqrt{3}|\geq \left(\frac{1}{|c_1|+|2c_2|+|2c_3|}\right)^{3}.\]

\item Let $p$ be a prime and consider $k$ $p$th roots of unity whose sum is not 0. Prove that the absolute value of their sum is at least $\frac{1}{k^{p-2}}$.
\end{enumerate}

